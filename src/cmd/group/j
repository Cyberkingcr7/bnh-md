import { Ctx } from "../../lib/ctx";
import { checkAdmin } from '../../lib/utils';
import { DatabaseHandler } from '../../db/DatabaseHandler';


const dbHandler = new DatabaseHandler();

module.exports = {
  name: "close",
  category: "Admin",
  code: async (ctx: Ctx): Promise<void> => {
    const userId = ctx.sender?.jid!
 
    console.log("Received message context:", ctx);

    // Check if the sender is an admin
    const senderJid = ctx.sender?.jid!;
    const isAdmin = await checkAdmin(ctx, senderJid);
    if (!isAdmin) {
      await ctx.reply("You do not have permission to use this command.");
      return;
    }
    try {
    // Close the group (e.g., disable messaging)
    await ctx.group()?.close();
    await ctx.reply("The group has been closed.");
  } catch (error) {
    console.error('Error handling close command:', error);
    await ctx.reply('An error occurred while trying to close the group.');
  }}}